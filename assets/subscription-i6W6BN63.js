(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Q="https://your-energy.b.goit.study/api";async function f(e,t={}){const n=await fetch(`${Q}${e}`,{headers:{...t.body?{"Content-Type":"application/json"}:{},...t.headers||{}},...t});let r=null;if((n.headers.get("content-type")||"").includes("application/json")?r=await n.json():r=await n.text(),!n.ok){const o=r&&typeof r=="object"&&(r.message||r.error)||`HTTP ${n.status}`;throw new Error(o)}return r}const u={getQuote(){return f("/quote")},getFilters({filter:e,page:t=1,limit:n=12}){const r=new URLSearchParams({filter:e,page:t,limit:n});return f(`/filters?${r.toString()}`)},getExercises({bodypart:e,muscles:t,equipment:n,keyword:r,page:i=1,limit:o=10}={}){const s=new URLSearchParams;return e&&s.set("bodypart",e),t&&s.set("muscles",t),n&&s.set("equipment",n),r&&s.set("keyword",r),s.set("page",String(i)),s.set("limit",String(o)),f(`/exercises?${s.toString()}`)},getExerciseById(e){return f(`/exercises/${e}`)},rateExercise(e,{rate:t,email:n,comment:r}={}){return f(`/exercises/${e}/rating`,{method:"PATCH",body:JSON.stringify({rate:t,email:n,comment:r})})},patchRating(e,t){return f(`/exercises/${e}/rating`,{method:"PATCH",body:JSON.stringify({rating:Math.round(Number(t))})})},postSubscription(e){return f("/subscription",{method:"POST",body:JSON.stringify({email:e})})}},I=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVR42mNgwALezOdNeLeQ5//7hbz+DMSC9wt59oM0vVvAs584DfMFFMAaIPg9kC9AUNPb+dwFSJr+v1/E04+h6N1C3vvIighikJNJ1rSQ5zzESQt4+onRAFKH1y/oGOg3e2yhJoBHE/ZQBEZoAD6bXs/nccC0aRHvfIQi7vvACK5HDqT3C/AE/Vug5vtQpzwHRvTbBXDDzmNoAinAldZA4q/mcxvABABPmfRHFSkiNwAAAABJRU5ErkJggg==",import.meta.url).href,R=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVR42mNgwAI+ffok/PXrV+P3798LMBALfvz4oQbSBKKJ0nD79m12kAYQ/vLli8H///+ZCWoCKhSHaQLhb9++yWJTpIusiBAGO/nnz586pGgCqtcE2wZ0ggwxGkDqUJz5+fNnMXwagAHCg+E3UCjh0oAzFEERic+m169f82Jo+v79uwKSZ0GBI4kcSBj+AQGYAqBmeZhTgDQbiI8Samh+YgNifmwRDhIHYk6YAAA1bjN1p333dQAAAABJRU5ErkJggg==",import.meta.url).href;let y=null,l=0,c=null;function M(){if(c!=null&&c.ratingModal&&(c!=null&&c.ratingValueEl)&&(c!=null&&c.starsWrap)&&(c!=null&&c.form))return c;const e=document.querySelector("#rating-modal"),t=document.querySelector("#rating-value"),n=document.querySelector("#rating-stars"),r=document.querySelector("#rating-form");return!e||!t||!n||!r?null:(c={ratingModal:e,ratingValueEl:t,starsWrap:n,form:r},c)}function N(e){return!(!e||e.classList.contains("is-hidden")||e.hidden||e.getAttribute("aria-hidden")==="true")}function z(){const e=document.querySelector("#exercise-modal"),t=document.querySelector("#rating-modal");return N(e)||N(t)}function Y(){const e=window.innerWidth-document.documentElement.clientWidth;document.body.style.overflow="hidden",document.body.style.paddingRight=`${e}px`}function G(){z()||(document.body.style.overflow="",document.body.style.paddingRight="")}function V(){const e=document.querySelector("#exercise-modal");if(!e)return;e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true");const t=document.querySelector("#exercise-modal-content");t&&(t.innerHTML="")}function B(e,t,n){return Math.min(n,Math.max(t,e))}function g(e,t){const n=B(Number(t)||0,0,5);e.querySelectorAll(".rating-star-btn").forEach(i=>{const o=Number(i.dataset.value),s=i.querySelector("img");s&&(s.src=o<=n?I:R)})}function K(e){e.innerHTML="";for(let t=1;t<=5;t++){const n=document.createElement("button");n.type="button",n.className="rating-star-btn",n.dataset.value=String(t),n.setAttribute("aria-label",`${t} star${t===1?"":"s"}`);const r=document.createElement("img");r.className="rating-star",r.src=R,r.alt="",r.setAttribute("aria-hidden","true"),n.append(r),e.append(n)}g(e,0)}function C(e){e.key==="Escape"&&S()}function S(){const e=M();if(!e)return;const{ratingModal:t,form:n}=e;t.classList.add("is-hidden"),t.hidden=!0,t.setAttribute("aria-hidden","true"),document.removeEventListener("keydown",C),n.reset(),y=null,l=0,G()}function le(){const e=M();if(!e){console.error("Rating modal DOM not found (#rating-modal, #rating-form, #rating-stars, #rating-value).");return}const{ratingModal:t,ratingValueEl:n,starsWrap:r,form:i}=e;t.dataset.bound!=="1"&&(t.dataset.bound="1",K(r),r.addEventListener("mouseover",o=>{const s=o.target.closest(".rating-star-btn");s&&g(r,Number(s.dataset.value))}),r.addEventListener("mouseleave",()=>{g(r,l)}),r.addEventListener("focusin",o=>{const s=o.target.closest(".rating-star-btn");s&&g(r,Number(s.dataset.value))}),r.addEventListener("focusout",()=>{g(r,l)}),r.addEventListener("click",o=>{const s=o.target.closest(".rating-star-btn");s&&(l=B(Number(s.dataset.value),0,5),n.textContent=l.toFixed(1),g(r,l))}),t.addEventListener("click",o=>{const s=o.target===t,d=o.target.closest("[data-close-rating]");(s||d)&&S()}),i.addEventListener("submit",async o=>{if(o.preventDefault(),!y)return alert("No exercise selected");if(!l)return alert("Please set rating");const s=new FormData(i),d=String(s.get("email")||"").trim();if(String(s.get("comment")||"").trim(),!d)return alert("Please enter email");try{await u.rateExercise(y,{rate:l,email:d}),S(),alert("Thanks! Rating sent.")}catch(b){console.error("Failed to rate exercise:",b),alert(`Failed to send rating: ${b.message}`)}}))}function W(e){const t=M();if(!t)return!1;V();const{ratingModal:n,ratingValueEl:r,starsWrap:i,form:o}=t;return y=e,l=0,r.textContent="0.0",g(i,0),o.reset(),n.hidden=!1,n.classList.remove("is-hidden"),n.setAttribute("aria-hidden","false"),Y(),document.addEventListener("keydown",C),!0}const x=600;function h(){const e=document.querySelector(".exercises__container");if(!e)return;const t=e.querySelector(".pagination");if(!t)return;let n=e.querySelector("[data-pagination-home]");n||(n=document.createElement("span"),n.dataset.paginationHome="1",n.hidden=!0,t.parentNode.insertBefore(n,t));const r=window.matchMedia(`(max-width: ${x}px)`).matches,i=e.querySelector(".quote-card")||e.querySelector(".quote")||e.querySelector("[data-quote]");r&&i?i.insertAdjacentElement("beforebegin",t):n.insertAdjacentElement("afterend",t)}document.addEventListener("DOMContentLoaded",()=>{h(),setTimeout(h,0),setTimeout(h,100)});window.addEventListener("resize",()=>{h(),m&&Z(m.totalPages,m.currentPage,m.onPageChange)});let m=null;function X(e,t){if(e<=3)return Array.from({length:e},(r,i)=>i+1);let n=t;return n>e-2&&(n=e-2),n<1&&(n=1),[n,n+1,n+2]}function j(e,t){return window.matchMedia(`(max-width: ${x}px)`).matches?X(e,t):Array.from({length:e},(r,i)=>i+1)}function Z(e,t,n){const r=document.querySelector(".pagination");if(!r)return;m={totalPages:e,currentPage:t,onPageChange:n};const i=j(e,t);r.innerHTML=i.map(o=>`
        <button
          class="pagination__btn"
          type="button"
          data-page="${o}"
          ${o===t?'aria-current="page"':""}
        >${o}</button>
      `).join(""),r.dataset.bound||(r.dataset.bound="1",r.addEventListener("click",o=>{const s=o.target.closest("[data-page]");if(!s)return;const d=Number(s.dataset.page);!Number.isFinite(d)||d===t||m!=null&&m.onPageChange&&m.onPageChange(d)}))}const q="yourEnergy:favorites",ee=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVR42mNgwALezOdNeLeQ5//7hbz+DMSC9wt59oM0vVvAs584DfMFFMAaIPg9kC9AUNPb+dwFSJr+v1/E04+h6N1C3vvIighikJNJ1rSQ5zzESQt4+onRAFKH1y/oGOg3e2yhJoBHE/ZQBEZoAD6bXs/nccC0aRHvfIQi7vvACK5HDqT3C/AE/Vug5vtQpzwHRvTbBXDDzmNoAinAldZA4q/mcxvABABPmfRHFSkiNwAAAABJRU5ErkJggg==",import.meta.url).href,te=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVR42mNgwAI+ffok/PXrV+P3798LMBALfvz4oQbSBKKJ0nD79m12kAYQ/vLli8H///+ZCWoCKhSHaQLhb9++yWJTpIusiBAGO/nnz586pGgCqtcE2wZ0ggwxGkDqUJz5+fNnMXwagAHCg+E3UCjh0oAzFEERic+m169f82Jo+v79uwKSZ0GBI4kcSBj+AQGYAqBmeZhTgDQbiI8Samh+YgNifmwRDhIHYk6YAAA1bjN1p333dQAAAABJRU5ErkJggg==",import.meta.url).href;let E=!1;const w=new Map;let p=null,a=null;function _(){try{const e=localStorage.getItem(q),t=e?JSON.parse(e):[];return Array.isArray(t)?t:[]}catch{return[]}}function $(e){return _().some(t=>(t==null?void 0:t._id)===e)}function T(e){localStorage.setItem(q,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("favorites:changed"))}function ne(e){const t=_();t.some(n=>(n==null?void 0:n._id)===(e==null?void 0:e._id))||(t.unshift(e),T(t))}function re(e){const t=_().filter(n=>(n==null?void 0:n._id)!==e);T(t)}function A(){const e=document.querySelector("#exercise-modal"),t=document.querySelector("#exercise-modal-content");return{modal:e,content:t}}function ie(){const{modal:e,content:t}=A();e&&(e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"),t&&(t.innerHTML=""),document.body.style.overflow="",document.body.style.paddingRight="")}function P(){const e=document.querySelector("#rating-modal");e&&(e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"))}function H(e){e.key==="Escape"&&v()}function oe(){const{modal:e}=A();if(!e)return;P();const t=window.innerWidth-document.documentElement.clientWidth;e.hidden=!1,e.classList.remove("is-hidden"),e.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",document.body.style.paddingRight=`${t}px`,document.addEventListener("keydown",H)}function v(){const{modal:e,content:t}=A();e&&(e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"),t&&(t.innerHTML=""),document.body.style.overflow="",document.body.style.paddingRight="",document.removeEventListener("keydown",H),p=null,a=null)}function se(e,t,n){return Math.min(n,Math.max(t,e))}function ae(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(1):"-"}function ce(e){const t=Number(e);return Number.isFinite(t)?se(Math.round(t),0,5):0}function de(e){const t=ce(e),n=5-t,r=`<img class="modal-exercise__star" src="${ee}" alt="" aria-hidden="true" />`,i=`<img class="modal-exercise__star" src="${te}" alt="" aria-hidden="true" />`;return`
    <div class="modal-exercise__stars" aria-label="${t} out of 5 stars">
      ${r.repeat(t)}${i.repeat(n)}
    </div>
  `}function ue(){const{content:e}=A();e&&(e.innerHTML=`
    <div class="modal-exercise__media"></div>
    <div class="modal-exercise__info">
      <h2 class="modal-exercise__title">Loading...</h2>
      <p class="modal-exercise__desc">Please wait</p>

      <div class="modal-exercise__actions">
        <button class="btn btn--light" type="button" disabled>Loading...</button>
        <button class="btn btn--outline" type="button" disabled>Give a rating</button>
      </div>
    </div>
  `)}function L(e,t){const{content:n}=A();if(!n)return;const r=(e==null?void 0:e.name)??"Exercise",i=(e==null?void 0:e.gifUrl)??"",o=ae(e==null?void 0:e.rating),s=de(e==null?void 0:e.rating),d=(e==null?void 0:e.target)??"-",b=(e==null?void 0:e.bodyPart)??"-",O=(e==null?void 0:e.burnedCalories)??"-",U=(e==null?void 0:e.description)??"",F=(e==null?void 0:e.equipment)??"body weight",J=(e==null?void 0:e.popular)??(e==null?void 0:e.popularity)??"150",D=$(t)?"Remove from favorites":"Add to favorites ♡";n.innerHTML=`
    <div class="modal-exercise__media">
      ${i?`<img class="modal-exercise__img" src="${i}" alt="${r}" loading="lazy" />`:""}
    </div>

    <div class="modal-exercise__info">
      <h2 class="modal-exercise__title">${r}</h2>

      <div class="modal-exercise__rating-row">
        <span class="modal-exercise__rating-num">${o}</span>
        ${s}
      </div>

      <div class="modal-exercise__divider"></div>

      <div class="modal-exercise__tags">
        <span class="tag">Target <b>${d}</b></span>
        <span class="tag">Body Part <b>${b}</b></span>
        <span class="tag">Equipment <b>${F}</b></span>
        <span class="tag">Popular <b>${J}</b></span>
      </div>

      <p class="modal-exercise__calories">
        Burned calories:<br> <b>${O} / 3 min</b>
      </p>

      <div class="modal-exercise__divider"></div>

      <p class="modal-exercise__desc">${U}</p>

      <div class="modal-exercise__actions">
        <button class="btn btn--light" type="button" data-fav-toggle>${D}</button>

        <button
          class="btn btn--outline"
          type="button"
          data-open-rating
          data-exercise-id="${t}"
        >
          Give a rating
        </button>
      </div>
    </div>
  `}function k(){const{modal:e,content:t}=A();!e||!t||e.dataset.bound||(e.dataset.bound="1",e.addEventListener("click",n=>{const r=n.target===e,i=n.target.closest("[data-close-modal]");(r||i)&&v()}),t.addEventListener("click",n=>{const r=n.target.closest("[data-open-rating]");if(r){const o=r.dataset.exerciseId;if(!o)return console.error("Give a rating: missing data-exercise-id");v(),ie(),requestAnimationFrame(()=>W(o));return}n.target.closest("[data-fav-toggle]")&&(!p||!a||($(p)?re(p):ne({_id:a._id,name:a.name,burnedCalories:a.burnedCalories,target:a.target,bodyPart:a.bodyPart,equipment:a.equipment,rating:a.rating,gifUrl:a.gifUrl,description:a.description,popular:a.popular??a.popularity}),L(a,p)))}))}k();document.addEventListener("DOMContentLoaded",k);async function me(e){if(!e){console.error("openExerciseModal: exerciseId is missing");return}const{modal:t,content:n}=A();if(!t||!n){console.warn("openExerciseModal: modal DOM not found on this page");return}if(!E){E=!0;try{if(p=e,P(),oe(),ue(),w.has(e)){const i=w.get(e);a=i,L(i,e);return}const r=await u.getExerciseById(e);if(!r)throw new Error("No data returned from API");w.set(e,r),a=r,L(r,e)}catch(r){console.error("openExerciseModal error:",r),alert("Failed to load exercise"),v()}finally{E=!1}}}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".footer__form");e&&e.addEventListener("submit",async t=>{var i;t.preventDefault();const n=e.querySelector('input[type="email"]')||e.querySelector('input[name="email"]'),r=(i=n==null?void 0:n.value)==null?void 0:i.trim();if(r)try{if(typeof(u==null?void 0:u.subscription)=="function")await u.subscription({email:r});else if(typeof(u==null?void 0:u.subscribe)=="function")await u.subscribe({email:r});else{const o=await fetch("https://your-energy.b.goit.study/api/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})});if(!o.ok)throw new Error(`Subscription failed: ${o.status}`)}e.reset()}catch(o){console.error("❌ Subscription error:",o)}})});export{u as a,le as i,me as o};
//# sourceMappingURL=subscription-i6W6BN63.js.map
