(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const G="https://your-energy.b.goit.study/api";async function g(e,t={}){const n=await fetch(`${G}${e}`,{headers:{...t.body?{"Content-Type":"application/json"}:{},...t.headers||{}},...t});let r=null;if((n.headers.get("content-type")||"").includes("application/json")?r=await n.json():r=await n.text(),!n.ok){const o=r&&typeof r=="object"&&(r.message||r.error)||`HTTP ${n.status}`;throw new Error(o)}return r}const l={getQuote(){return g("/quote")},getFilters({filter:e,page:t=1,limit:n=12}){const r=new URLSearchParams({filter:e,page:t,limit:n});return g(`/filters?${r.toString()}`)},getExercises({bodypart:e,muscles:t,equipment:n,keyword:r,page:i=1,limit:o=12}={}){const s=new URLSearchParams;return e&&s.set("bodypart",e),t&&s.set("muscles",t),n&&s.set("equipment",n),r&&s.set("keyword",r),s.set("page",String(i)),s.set("limit",String(o)),g(`/exercises?${s.toString()}`)},getExerciseById(e){return g(`/exercises/${e}`)},rateExercise(e,{rate:t,email:n,comment:r}={}){return g(`/exercises/${e}/rating`,{method:"PATCH",body:JSON.stringify({rate:t,email:n,comment:r})})},patchRating(e,t){return g(`/exercises/${e}/rating`,{method:"PATCH",body:JSON.stringify({rating:Math.round(Number(t))})})},postSubscription(e){return g("/subscription",{method:"POST",body:JSON.stringify({email:e})})}},V=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVR42mNgwALezOdNeLeQ5//7hbz+DMSC9wt59oM0vVvAs584DfMFFMAaIPg9kC9AUNPb+dwFSJr+v1/E04+h6N1C3vvIighikJNJ1rSQ5zzESQt4+onRAFKH1y/oGOg3e2yhJoBHE/ZQBEZoAD6bXs/nccC0aRHvfIQi7vvACK5HDqT3C/AE/Vug5vtQpzwHRvTbBXDDzmNoAinAldZA4q/mcxvABABPmfRHFSkiNwAAAABJRU5ErkJggg==",import.meta.url).href,$=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVR42mNgwAI+ffok/PXrV+P3798LMBALfvz4oQbSBKKJ0nD79m12kAYQ/vLli8H///+ZCWoCKhSHaQLhb9++yWJTpIusiBAGO/nnz586pGgCqtcE2wZ0ggwxGkDqUJz5+fNnMXwagAHCg+E3UCjh0oAzFEERic+m169f82Jo+v79uwKSZ0GBI4kcSBj+AQGYAqBmeZhTgDQbiI8Samh+YgNifmwRDhIHYk6YAAA1bjN1p333dQAAAABJRU5ErkJggg==",import.meta.url).href;let E=null,u=0,c=null;function C(){if(c!=null&&c.ratingModal&&(c!=null&&c.ratingValueEl)&&(c!=null&&c.starsWrap)&&(c!=null&&c.form))return c;const e=document.querySelector("#rating-modal"),t=document.querySelector("#rating-value"),n=document.querySelector("#rating-stars"),r=document.querySelector("#rating-form");return!e||!t||!n||!r?null:(c={ratingModal:e,ratingValueEl:t,starsWrap:n,form:r},c)}function q(e){return!(!e||e.classList.contains("is-hidden")||e.hidden||e.getAttribute("aria-hidden")==="true")}function K(){const e=document.querySelector("#exercise-modal"),t=document.querySelector("#rating-modal");return q(e)||q(t)}function W(){const e=window.innerWidth-document.documentElement.clientWidth;document.body.style.overflow="hidden",document.body.style.paddingRight=`${e}px`}function X(){K()||(document.body.style.overflow="",document.body.style.paddingRight="")}let L=null;function b(e,t="success"){const n=document.querySelector(".rating-toast");n&&n.remove(),L&&clearTimeout(L);const r=document.createElement("div");r.className=`rating-toast rating-toast--${t}`,r.textContent=e,document.body.appendChild(r),requestAnimationFrame(()=>r.classList.add("is-visible")),L=setTimeout(()=>{r.classList.remove("is-visible"),setTimeout(()=>r.remove(),250)},2200)}function T(e,t,n){return Math.min(n,Math.max(t,e))}function A(e,t){const n=T(Number(t)||0,0,5);e.querySelectorAll(".rating-star-btn").forEach(i=>{const o=Number(i.dataset.value),s=i.querySelector("img");s&&(s.src=o<=n?V:$)})}function j(e){e.innerHTML="";for(let t=1;t<=5;t++){const n=document.createElement("button");n.type="button",n.className="rating-star-btn",n.dataset.value=String(t),n.setAttribute("aria-label",`${t} star${t===1?"":"s"}`);const r=document.createElement("img");r.className="rating-star",r.src=$,r.alt="",r.setAttribute("aria-hidden","true"),n.append(r),e.append(n)}A(e,0)}function k(e){e.key==="Escape"&&N()}function N(){const e=C();if(!e)return;const{ratingModal:t,form:n}=e;t.classList.add("is-hidden"),t.hidden=!0,t.setAttribute("aria-hidden","true"),document.removeEventListener("keydown",k),n.reset(),E=null,u=0,X(),window.dispatchEvent(new CustomEvent("rating:closed"))}function Ae(){const e=C();if(!e){console.error("Rating modal DOM not found (#rating-modal, #rating-form, #rating-stars, #rating-value).");return}const{ratingModal:t,ratingValueEl:n,starsWrap:r,form:i}=e;t.dataset.bound!=="1"&&(t.dataset.bound="1",j(r),r.addEventListener("mouseover",o=>{const s=o.target.closest(".rating-star-btn");s&&A(r,Number(s.dataset.value))}),r.addEventListener("mouseleave",()=>{A(r,u)}),r.addEventListener("focusin",o=>{const s=o.target.closest(".rating-star-btn");s&&A(r,Number(s.dataset.value))}),r.addEventListener("focusout",()=>{A(r,u)}),r.addEventListener("click",o=>{const s=o.target.closest(".rating-star-btn");s&&(u=T(Number(s.dataset.value),0,5),n.textContent=u.toFixed(1),A(r,u))}),t.addEventListener("click",o=>{const s=o.target===t,d=o.target.closest("[data-close-rating]");(s||d)&&N()}),i.addEventListener("submit",async o=>{if(o.preventDefault(),!E){b("No exercise selected","error");return}if(!u){b("Please set rating","error");return}const s=new FormData(i),d=String(s.get("email")||"").trim();if(!d){b("Please enter email","error");return}try{await l.rateExercise(E,{rate:u,email:d}),N(),b("Thanks! Rating sent.","success")}catch(v){console.error("Failed to rate exercise:",v),b(`Failed to send rating: ${v.message}`,"error")}}))}function Z(e){const t=C();if(!t)return!1;const{ratingModal:n,ratingValueEl:r,starsWrap:i,form:o}=t;return E=e,u=0,r.textContent="0.0",A(i,0),o.reset(),n.hidden=!1,n.classList.remove("is-hidden"),n.setAttribute("aria-hidden","false"),W(),document.addEventListener("keydown",k),!0}const P=600;function h(){const e=document.querySelector(".exercises__container");if(!e)return;const t=e.querySelector(".pagination");if(!t)return;let n=e.querySelector("[data-pagination-home]");n||(n=document.createElement("span"),n.dataset.paginationHome="1",n.hidden=!0,t.parentNode.insertBefore(n,t));const r=window.matchMedia(`(max-width: ${P}px)`).matches,i=e.querySelector(".quote-card")||e.querySelector(".quote")||e.querySelector("[data-quote]");r&&i?i.insertAdjacentElement("beforebegin",t):n.insertAdjacentElement("afterend",t)}document.addEventListener("DOMContentLoaded",()=>{h(),setTimeout(h,0),setTimeout(h,100)});window.addEventListener("resize",()=>{h(),m&&ne(m.totalPages,m.currentPage,m.onPageChange)});let m=null;function ee(e,t){if(e<=3)return Array.from({length:e},(r,i)=>i+1);let n=t;return n>e-2&&(n=e-2),n<1&&(n=1),[n,n+1,n+2]}function te(e,t){return window.matchMedia(`(max-width: ${P}px)`).matches?ee(e,t):Array.from({length:e},(r,i)=>i+1)}function ne(e,t,n){const r=document.querySelector(".pagination");if(!r)return;m={totalPages:e,currentPage:t,onPageChange:n};const i=te(e,t);r.innerHTML=i.map(o=>`
        <button
          class="pagination__btn"
          type="button"
          data-page="${o}"
          ${o===t?'aria-current="page"':""}
        >${o}</button>
      `).join(""),r.dataset.bound||(r.dataset.bound="1",r.addEventListener("click",o=>{const s=o.target.closest("[data-page]");if(!s)return;const d=Number(s.dataset.page);!Number.isFinite(d)||d===t||m!=null&&m.onPageChange&&m.onPageChange(d)}))}const O="yourEnergy:favorites",re=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVR42mNgwALezOdNeLeQ5//7hbz+DMSC9wt59oM0vVvAs584DfMFFMAaIPg9kC9AUNPb+dwFSJr+v1/E04+h6N1C3vvIighikJNJ1rSQ5zzESQt4+onRAFKH1y/oGOg3e2yhJoBHE/ZQBEZoAD6bXs/nccC0aRHvfIQi7vvACK5HDqT3C/AE/Vug5vtQpzwHRvTbBXDDzmNoAinAldZA4q/mcxvABABPmfRHFSkiNwAAAABJRU5ErkJggg==",import.meta.url).href,ie=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVR42mNgwAI+ffok/PXrV+P3798LMBALfvz4oQbSBKKJ0nD79m12kAYQ/vLli8H///+ZCWoCKhSHaQLhb9++yWJTpIusiBAGO/nnz586pGgCqtcE2wZ0ggwxGkDqUJz5+fNnMXwagAHCg+E3UCjh0oAzFEERic+m169f82Jo+v79uwKSZ0GBI4kcSBj+AQGYAqBmeZhTgDQbiI8Samh+YgNifmwRDhIHYk6YAAA1bjN1p333dQAAAABJRU5ErkJggg==",import.meta.url).href;let M=!1;const _=new Map;let p=null,a=null,w=!1,y="";function B(){try{const e=localStorage.getItem(O),t=e?JSON.parse(e):[];return Array.isArray(t)?t:[]}catch{return[]}}function F(e){return B().some(t=>(t==null?void 0:t._id)===e)}function U(e){localStorage.setItem(O,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("favorites:changed"))}function oe(e){const t=B();t.some(n=>(n==null?void 0:n._id)===(e==null?void 0:e._id))||(t.unshift(e),U(t))}function se(e){const t=B().filter(n=>(n==null?void 0:n._id)!==e);U(t)}function f(){const e=document.querySelector("#exercise-modal"),t=document.querySelector("#exercise-modal-content");return{modal:e,content:t}}function H(){const e=document.querySelector("#rating-modal");e&&(e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"))}function ae(){const{modal:e}=f();return!e||!(!e.hidden&&!e.classList.contains("is-hidden"))?!1:(w=!0,y=e.style.display||"",e.style.display="none",e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"),document.removeEventListener("keydown",S),!0)}function ce(){if(!w)return!1;const{modal:e}=f();return e?(e.style.display=y,e.hidden=!1,e.classList.remove("is-hidden"),e.setAttribute("aria-hidden","false"),document.addEventListener("keydown",S),w=!1,y="",!0):!1}function S(e){e.key==="Escape"&&x()}function de(){const{modal:e}=f();if(!e)return;H();const t=window.innerWidth-document.documentElement.clientWidth;e.hidden=!1,e.classList.remove("is-hidden"),e.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",document.body.style.paddingRight=`${t}px`,document.addEventListener("keydown",S)}function x(){const{modal:e,content:t}=f();e&&(e.classList.add("is-hidden"),e.hidden=!0,e.setAttribute("aria-hidden","true"),e.style.display=y,t&&(t.innerHTML=""),document.body.style.overflow="",document.body.style.paddingRight="",document.removeEventListener("keydown",S),p=null,a=null,w=!1,y="")}function le(e,t,n){return Math.min(n,Math.max(t,e))}function ue(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(1):"-"}function me(e){const t=Number(e);return Number.isFinite(t)?le(Math.round(t),0,5):0}function fe(e){const t=me(e),n=5-t,r=`<img class="modal-exercise__star" src="${re}" alt="" aria-hidden="true" />`,i=`<img class="modal-exercise__star" src="${ie}" alt="" aria-hidden="true" />`;return`
    <div class="modal-exercise__stars" aria-label="${t} out of 5 stars">
      ${r.repeat(t)}${i.repeat(n)}
    </div>
  `}function ge(){const{content:e}=f();e&&(e.innerHTML=`
    <div class="modal-exercise__media"></div>
    <div class="modal-exercise__info">
      <h2 class="modal-exercise__title">Loading...</h2>
      <p class="modal-exercise__desc">Please wait</p>

      <div class="modal-exercise__actions">
        <button class="btn btn--light" type="button" disabled>Loading...</button>
        <button class="btn btn--outline" type="button" disabled>Give a rating</button>
      </div>
    </div>
  `)}function R(e,t){const{content:n}=f();if(!n)return;const r=(e==null?void 0:e.name)??"Exercise",i=(e==null?void 0:e.gifUrl)??"",o=ue(e==null?void 0:e.rating),s=fe(e==null?void 0:e.rating),d=(e==null?void 0:e.target)??"-",v=(e==null?void 0:e.bodyPart)??"-",J=(e==null?void 0:e.burnedCalories)??"-",Q=(e==null?void 0:e.description)??"",I=(e==null?void 0:e.equipment)??"body weight",z=(e==null?void 0:e.popular)??(e==null?void 0:e.popularity)??"150",Y=F(t)?"Remove from favorites":"Add to favorites ♡";n.innerHTML=`
    <div class="modal-exercise__media">
      ${i?`<img class="modal-exercise__img" src="${i}" alt="${r}" loading="lazy" />`:""}
    </div>

    <div class="modal-exercise__info">
      <h2 class="modal-exercise__title">${r}</h2>

      <div class="modal-exercise__rating-row">
        <span class="modal-exercise__rating-num">${o}</span>
        ${s}
      </div>

      <div class="modal-exercise__divider"></div>

      <div class="modal-exercise__tags">
        <span class="tag">Target <b>${d}</b></span>
        <span class="tag">Body Part <b>${v}</b></span>
        <span class="tag">Equipment <b>${I}</b></span>
        <span class="tag">Popular <b>${z}</b></span>
      </div>

      <p class="modal-exercise__calories">
        Burned calories:<br> <b>${J} / 3 min</b>
      </p>

      <div class="modal-exercise__divider"></div>

      <p class="modal-exercise__desc">${Q}</p>

      <div class="modal-exercise__actions">
        <button class="btn btn--light" type="button" data-fav-toggle>${Y}</button>

        <button
          class="btn btn--outline"
          type="button"
          data-open-rating
          data-exercise-id="${t}"
        >
          Give a rating
        </button>
      </div>
    </div>
  `}function D(){const{modal:e,content:t}=f();!e||!t||e.dataset.bound||(e.dataset.bound="1",e.addEventListener("click",n=>{const r=n.target===e,i=n.target.closest("[data-close-modal]");(r||i)&&x()}),t.addEventListener("click",n=>{const r=n.target.closest("[data-open-rating]");if(r){const o=r.dataset.exerciseId;if(!o)return console.error("Give a rating: missing data-exercise-id");ae(),setTimeout(()=>Z(o),0);return}n.target.closest("[data-fav-toggle]")&&(!p||!a||(F(p)?se(p):oe({_id:a._id,name:a.name,burnedCalories:a.burnedCalories,target:a.target,bodyPart:a.bodyPart,equipment:a.equipment,rating:a.rating,gifUrl:a.gifUrl,description:a.description,popular:a.popular??a.popularity}),R(a,p)))}))}D();document.addEventListener("DOMContentLoaded",D);async function pe(e){if(!e){console.error("openExerciseModal: exerciseId is missing");return}const{modal:t,content:n}=f();if(!t||!n){console.warn("openExerciseModal: modal DOM not found on this page");return}if(!M){M=!0;try{if(p=e,H(),de(),ge(),_.has(e)){const i=_.get(e);a=i,R(i,e);return}const r=await l.getExerciseById(e);if(!r)throw new Error("No data returned from API");_.set(e,r),a=r,R(r,e)}catch(r){console.error("openExerciseModal error:",r),alert("Failed to load exercise"),x()}finally{M=!1}}}window.addEventListener("rating:closed",()=>{ce()});function be(){const e=document.querySelector("[data-mobile-menu]"),t=document.querySelector("[data-menu-open]"),n=document.querySelectorAll("[data-menu-close]");if(!e||!t){console.warn("Mobile menu: markup not found",{menu:e,openBtn:t});return}const r=()=>{e.classList.add("is-open"),e.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true"),document.body.style.overflow="hidden"},i=()=>{e.classList.remove("is-open"),e.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false"),document.body.style.overflow=""};t.addEventListener("click",r),n.forEach(o=>o.addEventListener("click",i)),document.addEventListener("keydown",o=>{o.key==="Escape"&&i()})}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".footer__form");e&&e.addEventListener("submit",async t=>{var i;t.preventDefault();const n=e.querySelector('input[type="email"]')||e.querySelector('input[name="email"]'),r=(i=n==null?void 0:n.value)==null?void 0:i.trim();if(r)try{if(typeof(l==null?void 0:l.subscription)=="function")await l.subscription({email:r});else if(typeof(l==null?void 0:l.subscribe)=="function")await l.subscribe({email:r});else{const o=await fetch("https://your-energy.b.goit.study/api/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})});if(!o.ok)throw new Error(`Subscription failed: ${o.status}`)}e.reset()}catch(o){console.error("❌ Subscription error:",o)}})});export{be as a,l as b,Ae as i,pe as o};
//# sourceMappingURL=subscription-BcEsYp59.js.map
